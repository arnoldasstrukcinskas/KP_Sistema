@inject IJSRuntime JS
@inject NavigationManager navigation
@inject AuthenticationService authenticationService
@inject HttpClient Http
@attribute [Authorize]

@* <AuthorizeView> *@
<div class="horizontal-menu">
    <nav class="bg-light border navbar navbar-expand-md navbar-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="/"><span class="purple fw-bold">Utility Service System</span></a>
            <button aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbar" data-bs-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbar">
                @* <Authorized> *@
                <ul class="navbar-nav me-auto mt-2">
                    <li class="nav-item"><a class="nav-link" href="/home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/profile">Profile</a></li>
                    <AuthorizeView Roles="Admin">
                        <li class="nav-item"><a class="nav-link" href="/allusers">All Users</a></li>
                    </AuthorizeView>
                    @* <li class="nav-item"><a class="nav-link" href="/quote">Updates</a></li> *@
                </ul>
                <ul class="navbar-nav ms-auto mt-2">
                    <li class="nav-item"><a class="nav-link" href="/Users/changePassword">Change Password</a></li>
                    <li class="nav-item"><button class="btn btn-outline-danger" @onclick="() => LogOut()">Log Out</button></li>
                </ul>
                @* </Authorized>
                <NotAuthorized>
                <ul class="navbar-nav ms-auto mt-2">
                    <li class="nav-item"><a class="nav-link" href="/register">Register</a></li>
                    <li class="nav-item"><a class="nav-link" href="/login">Log In</a></li>
                </ul>
                </NotAuthorized> *@
            </div>
        </div>
    </nav>
</div>
@* </AuthorizeView> *@
@code {
    protected async Task LogOut()
    {
        await JS.InvokeVoidAsync("auth.clearUserData");
        authenticationService.NotifyUserLogout();
        Http.DefaultRequestHeaders.Authorization = null;
        navigation.NavigateTo("/login");
    }
}
